---
layout: post
title:  "마이크로 서비스, 콜하지 말고 이벤트 컨슈밍하기"
date:   2018-8-22
description: API 콜 방식을 버리고 왜 이벤트 컨슈밍 방식을 선택해야하는지 알아봅시다.
---

<p class="intro"><span class="dropcap">A</span>PI Gateway는 마이크로서비스를 시작하면서 생기는 짐입니다. 주 목적은 Monolithic에서 시작한 서비스 콜구조를 지원하기 위해서입니다. API 게이트 웨이를 심도 있게 운영하는것은 비용, 스트레스, 효율등을 고려하면 좋은 선택이 아닙니다, 이벤트 드리븐을 사용해야합니다.</p>

# 예제로 보는 API 콜 방식의 문제
우리는 왜 API 콜 방식이 우리에게 고통을 주는지 가입자에게 쿠폰을 발송하는 간단한 서비스 예제를 통해서 살펴봅니다.

{% highlight ruby %}
create account {
   create coupon
}
{% endhighlight %}

계정이 생성되면 내부적으로 다시 쿠폰을 생성합니다.  콜스텍을 보면 다음과 같습니다.
1. call create account
2. create account via API gateway
3. call create coupon
4. create coupon via API gateway

쿠폰 생성은 계정 생성에 의존적입니다. 따라서 이벤트 기간이 끝나면 account 서비스의 create 부분을 다음과 같이 수정해야합니다.

{% highlight ruby %}
create account {
}
{% endhighlight %}

# 이벤트 드리븐은 해결책인가
